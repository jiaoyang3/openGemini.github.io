import{_ as o,X as t,Y as r,$ as s,a1 as n,Z as p,a3 as a,C as l}from"./framework-1e2d737a.js";const c={},k=a('<p>本章主要介绍如下函数：</p><table><thead><tr><th>聚合函数</th><th>说明</th></tr></thead><tbody><tr><td><a href="#count">COUNT()</a></td><td>统计数据总量</td></tr><tr><td><a href="#count-time"><strong>COUNT(time)</strong></a></td><td>按时间列统计数据</td></tr><tr><td><a href="#mean">MEAN()</a></td><td>平均值</td></tr><tr><td><a href="#sum">SUM ()</a></td><td>求和</td></tr><tr><td><a href="#mode">MODE()</a></td><td>最频繁值</td></tr><tr><td><a href="#stddev">STDDEV()</a></td><td>标准差</td></tr><tr><td><a href="#median">MEDIAN()</a></td><td>中位数</td></tr><tr><td><a href="#spread">SPREAD()</a></td><td>跨度值</td></tr><tr><td><a href="#distinct">DISTINCT()</a></td><td>去重</td></tr><tr><td><a href="#irate"><strong>IRATE()</strong></a></td><td>( |A<sub>n</sub> - A<sub>n-1</sub>| ) / ( |T<sub>n</sub> - T<sub>n-1</sub>| )</td></tr><tr><td><a href="#rate"><strong>RATE()</strong></a></td><td>( |A<sub>n</sub>-A<sub>1</sub>| ) / ( |T<sub>n</sub>-T<sub>1</sub>|)</td></tr><tr><td><a href="#moving-average">MOVING_AVERAGE()</a></td><td>滑动平均</td></tr><tr><td><a href="#holt-winters">HOLT_WINTERS()</a></td><td>预测未来N个值</td></tr><tr><td><a href="#cumulative-sum">CUMULATIVE_SUM()</a></td><td>累积求和</td></tr><tr><td><a href="derivative">DERIVATIVE()</a></td><td>后续值的变化率</td></tr><tr><td><a href="#difference">DIFFERENCE()</a></td><td>后续值的差值</td></tr><tr><td><a href="#elapsed">ELAPSED()</a></td><td>后续值的时间差值</td></tr><tr><td><a href="#non-negative-derivative">NON_NEGATIVE_DERIVATIVE()</a></td><td>后续值的非负变化率</td></tr><tr><td><a href="#non-negative-difference">NON_NEGATIVE_DIFFERENCE()</a></td><td>后续值的非负差值</td></tr></tbody></table>',2),i={class:"hint-container tip"},u=s("p",{class:"hint-container-title"},"提示",-1),m={href:"https://docs.influxdata.com/influxdb/v1/query_language/functions",target:"_blank",rel:"noopener noreferrer"},d=a(`<h2 id="count" tabindex="-1"><a class="header-anchor" href="#count" aria-hidden="true">#</a> COUNT()</h2><p>返回给定Field列非空值数量，不支持对Tag列计算, 不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>嵌套语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>支持将<code>DISTINCT()</code>函数嵌套在<code>COUNT()</code>函数里，统计不同值的数量。</p><p><strong>示例</strong></p><ul><li><strong>计算指定field key的field value的数目</strong></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15258</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement<code>h2o_feet</code>中的<code>water_level</code>的非空field value的数量。</p><ul><li><strong>计数measurement中每个field key关联的field value的数量</strong></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count_level description <span class="token operator">|</span> count_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15258</span>                   <span class="token operator">|</span> <span class="token number">15258</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+-------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回与measurement<code>h2o_feet</code>相关联的每个field key的非空field value的数量。<code>h2o_feet</code>有两个field keys：<code>level_description</code>和<code>water_level</code></p><ul><li><strong>计算匹配一个正则表达式的每个field key关联的field value的数目</strong></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">/</span>water<span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15258</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement<code>h2o_feet</code>中包含<code>water</code>单词的每个field key的非空字段值的数量。</p><ul><li><strong>计数包括多个子句的field key的field value的数目</strong></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回<code>water_level</code>field key中的非空field value的数量。它涵盖<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间的<code>时间段</code>，并将结果分组为7分钟的时间间隔和每个tag。并用<code>1000</code>填充空的时间间隔，并返回4个数据point，表格返回1。</p><ul><li><strong>计算一个field key的distinct的field value的数量</strong></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span><span class="token punctuation">(</span><span class="token string">&quot;level description&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询返回measurement为<code>h2o_feet</code>field key为<code>level description</code>的唯一field value的数量。</p><p><strong><code>COUNT()</code>的常见问题&gt;</strong></p><ul><li><strong><code>COUNT()</code>和<code>fill()</code></strong></li></ul><p>大多数函数对于没有数据的时间间隔返回<code>null</code>值，<code>fill()</code>将该<code>null</code>值替换为<code>fill_option</code>。 <code>COUNT()</code>针对没有数据的时间间隔返回<code>0</code>，<code>fill(&lt;fill_option&gt;)</code>用<code>fill_option</code>替换0值。</p><p><strong>示例</strong></p><p>下面的代码块中的第一个查询不包括<code>fill()</code>。有些时间段没有数据，因此该时间间隔的值返回为零。第二个查询包括<code>fill(800000)</code>; 它将没有数据的间隔中的零替换为<code>800000</code>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span>  <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span> <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">800000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> count  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">800000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sum" tabindex="-1"><a class="header-anchor" href="#sum" aria-hidden="true">#</a> SUM()</h2><p>返回指定Field列的值的总和，限 int 和 float 类型。不支持对Tag列计算</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_CLAUSE<span class="token punctuation">]</span> FROM_CLAUSE <span class="token punctuation">[</span>WHERE_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_CLAUSE<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_CLAUSE<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>SUM(field_key)</code> 返回field key对应的field value的总和。</p><p><code>SUM(/regular_expression/)</code> 返回与正则表达式匹配的每个field key对应的field value的总和。</p><p><code>SUM(*)</code> 返回在measurement中每个field key对应的field value的总和。</p><p><strong>示例</strong></p><p><strong>计算指定field key对应的field value的总和</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">67774.98933334895</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的总和。</p><p><strong>计算measurement中每个field key对应的field value的总和</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum_water_level   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">67774.98933334895</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值的field key对应的field value的总和。measurement <code>h2o_feet</code>中只有一个数值类型的field：<code>water_level</code>。</p><p><strong>计算与正则表达式匹配的每个field key对应的field value的总和</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token operator">/</span>water<span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum_water_level   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1970</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span>T00:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">67774.98933334895</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中每个存储数值并包含单词<code>water</code>的field key对应的field value的总和。</p><p><strong>计算指定field key对应的field value的总和并包含多个子句</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-20T00:12:01Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-20T08:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">4</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> sum    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">10</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1000</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">17</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.684</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">17.316</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">20</span>T00:<span class="token number">31</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.619</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回measurement <code>h2o_feet</code>中field key <code>water_level</code>对应的field value的总和，它涵盖的时间范围在<code>2019-08-20T00:12:01Z</code>和<code>2019-08-20T08:00:00Z</code>之间，并将查询结果按7分钟的时间间隔和每个tag进行分组，同时，该查询用<code>1000</code>填充没有数据的时间间隔，并将返回的数据point个数限制为4。</p><h2 id="count-time" tabindex="-1"><a class="header-anchor" href="#count-time" aria-hidden="true">#</a> COUNT(time)</h2><p>返回time列的数量，由于其他列可能出现空值，导致count返回的数量不准确，由于time列不可能存在空值，因此Count(time)则为准确值。</p><p><strong>语法</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT COUNT(time) [INTO_CLAUSE] FROM_CLAUSE [WHERE_CLAUSE] [GROUP_BY_CLAUSE] [ORDER_BY_CLAUSE] [LIMIT_CLAUSE] [OFFSET_CLAUSE]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">time</span><span class="token punctuation">)</span> <span class="token keyword">from</span> h2o_quality
name: h2o_quality
<span class="token operator">+</span><span class="token comment">------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> count <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">15258</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------+</span>

<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其他语法例子可以参考<a href="#count">COUNT</a></p><h2 id="mean" tabindex="-1"><a class="header-anchor" href="#mean" aria-hidden="true">#</a> MEAN()</h2><p>返回指定Field列的算术平均值，不支持对Tag列计算, 不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算所有Field的算术平均值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_quality
name: h2o_quality
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> mean_index        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">49.85705859221392</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>计算所有满足正则匹配的Field的算术平均值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span><span class="token operator">/</span>water<span class="token operator">/</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token string">&quot;h2o_feet&quot;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> mean_water_level  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">4.441931402107023</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>按location分组求算术平均值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> mean              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">5.359142420303915</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_feet
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> mean               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">3.5307120942458807</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围，按location和time分组求平均值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location<span class="token punctuation">,</span><span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>d<span class="token punctuation">)</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> mean               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000000</span> <span class="token operator">|</span> <span class="token number">5.2549815615608315</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566432000000000000</span> <span class="token operator">|</span> <span class="token number">5.26997790112619</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567036800000000000</span> <span class="token operator">|</span> <span class="token number">5.272352687407984</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567641600000000000</span> <span class="token operator">|</span> <span class="token number">5.460220592024403</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568246400000000000</span> <span class="token operator">|</span> <span class="token number">5.542803999609522</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_feet
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> mean               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000000</span> <span class="token operator">|</span> <span class="token number">3.3571135810808332</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566432000000000000</span> <span class="token operator">|</span> <span class="token number">3.2962888674321427</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567036800000000000</span> <span class="token operator">|</span> <span class="token number">3.535538707562054</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567641600000000000</span> <span class="token operator">|</span> <span class="token number">3.5668245066446427</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568246400000000000</span> <span class="token operator">|</span> <span class="token number">3.9068693439619184</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="mode" tabindex="-1"><a class="header-anchor" href="#mode" aria-hidden="true">#</a> MODE()</h2><p>返回Field列中最常见的值，不支持对Tag列计算, 不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">MODE</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算指定Field列出现次数最多的值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">MODE</span><span class="token punctuation">(</span><span class="token keyword">index</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_quality
name: h2o_quality
<span class="token operator">+</span><span class="token comment">------+------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> <span class="token keyword">mode</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">80</span>   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果存在两个值出现次数相同，则返回时间戳最早的那个值</p></div><p><strong>计算每一列出现次数最多的值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">MODE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet
name: h2o_feet
<span class="token operator">+</span><span class="token comment">------+------------------------+------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> mode_level description <span class="token operator">|</span> mode_water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+------------------------+------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token operator">between</span> <span class="token number">3</span> <span class="token operator">and</span> <span class="token number">6</span> feet   <span class="token operator">|</span> <span class="token number">2.69</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+------------------------+------------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围，按location和time分组求water_level出现次数最多的值。<em>time(7d)表示数据按7天分组</em></strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">MODE</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location<span class="token punctuation">,</span><span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">7</span>d<span class="token punctuation">)</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> <span class="token keyword">mode</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000000</span> <span class="token operator">|</span> <span class="token number">6.713</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566432000000000000</span> <span class="token operator">|</span> <span class="token number">8.386</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567036800000000000</span> <span class="token operator">|</span> <span class="token number">9.728</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567641600000000000</span> <span class="token operator">|</span> <span class="token number">9.098</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568246400000000000</span> <span class="token operator">|</span> <span class="token number">2.831</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_feet
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> <span class="token keyword">mode</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000000</span> <span class="token operator">|</span> <span class="token number">4.8</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566432000000000000</span> <span class="token operator">|</span> <span class="token number">2.979</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567036800000000000</span> <span class="token operator">|</span> <span class="token number">5.328</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567641600000000000</span> <span class="token operator">|</span> <span class="token number">4.101</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568246400000000000</span> <span class="token operator">|</span> <span class="token number">2.034</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围和localtion，按time分组求water_level出现次数最多的值。<em>time(3d)表示数据按3天分组</em></strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">MODE</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span> <span class="token operator">and</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">3</span>d<span class="token punctuation">)</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> <span class="token keyword">mode</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000000</span> <span class="token operator">|</span> <span class="token number">4.8</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566086400000000000</span> <span class="token operator">|</span> <span class="token number">2.352</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566345600000000000</span> <span class="token operator">|</span> <span class="token number">3.11</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566604800000000000</span> <span class="token operator">|</span> <span class="token number">3.855</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566864000000000000</span> <span class="token operator">|</span> <span class="token number">4.429</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567123200000000000</span> <span class="token operator">|</span> <span class="token number">1.375</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567382400000000000</span> <span class="token operator">|</span> <span class="token number">2.69</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567641600000000000</span> <span class="token operator">|</span> <span class="token number">1.722</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567900800000000000</span> <span class="token operator">|</span> <span class="token number">5.377</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568160000000000000</span> <span class="token operator">|</span> <span class="token number">6.07</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568419200000000000</span> <span class="token operator">|</span> <span class="token number">2.116</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568678400000000000</span> <span class="token operator">|</span> <span class="token number">3.917</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">12</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="stddev" tabindex="-1"><a class="header-anchor" href="#stddev" aria-hidden="true">#</a> STDDEV()</h2><p>返回指定Field列的标准差，不支持对Tag列计算，不支持SLIMIT和SOFFSET</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> STDDEV<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>指定时间范围，计算water_level列的标准差</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> STDDEV<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> stddev             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">2.2791252793622587</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围，分组计算water_level列的标准差</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> STDDEV<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">---------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> stddev            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------------------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">2.553231100033397</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_feet
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> stddev             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">1.4875647953606128</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围，分组计算water_level列的标准差，从第3条数据开始返回10条数据</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> STDDEV<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-19T00:59:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">12</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">18000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token keyword">OFFSET</span> <span class="token number">2</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">------+---------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> stddev              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+---------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09545941546026109</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.0975807358037642</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09050966799184483</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.08768124086706051</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09758073580369138</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09263098833540352</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.10253048327207068</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09050966799184483</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.08768124086714155</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09050966799188409</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+---------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> STDDEV<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> location<span class="token operator">=</span><span class="token string">&#39;coyote_creek&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-08-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2019-08-19T00:59:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">12</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span> fill<span class="token punctuation">(</span><span class="token number">18000</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token keyword">OFFSET</span> <span class="token number">2</span>
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">------+---------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span> <span class="token operator">|</span> stddev              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+---------------------+</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09545941546026109</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.0975807358037642</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09050966799184483</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.08768124086706051</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09758073580369138</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09263098833540352</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.10253048327207068</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09050966799184483</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.08768124086714155</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span> <span class="token number">0.09050966799188409</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+---------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="median" tabindex="-1"><a class="header-anchor" href="#median" aria-hidden="true">#</a> MEDIAN()</h2><p>返回指定Field列数据的中位数，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> MEDIAN<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>指定时间范围，计算pH列的中位数</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MEDIAN<span class="token punctuation">(</span>pH<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_pH <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span>
name: h2o_pH
<span class="token operator">+</span><span class="token comment">---------------------+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> median <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围，分组计算pH列的中位数</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MEDIAN<span class="token punctuation">(</span>pH<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_pH <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location<span class="token punctuation">,</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">1</span>d<span class="token punctuation">)</span> FILL<span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
name: h2o_pH
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">---------------------+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> median <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000000</span> <span class="token operator">|</span> <span class="token number">700</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1565913600000000000</span> <span class="token operator">|</span> <span class="token number">700</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566000000000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566086400000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566172800000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566259200000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566345600000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566432000000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566518400000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1566604800000000000</span> <span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+--------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="spread" tabindex="-1"><a class="header-anchor" href="#spread" aria-hidden="true">#</a> SPREAD()</h2><p>返回指定Field列最大值和最小值之间的差值，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SPREAD<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>指定时间范围，计算pH列的跨度</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>pH<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>pH<span class="token punctuation">)</span><span class="token punctuation">,</span>SPREAD<span class="token punctuation">(</span>pH<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_pH <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span>
name: h2o_pH
<span class="token operator">+</span><span class="token comment">---------------------+-----+-----+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> max <span class="token operator">|</span> min <span class="token operator">|</span> spread <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----+-----+--------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">8</span>   <span class="token operator">|</span> <span class="token number">6</span>   <span class="token operator">|</span> <span class="token number">2</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----+-----+--------+</span>
<span class="token number">4</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间范围和Tag，计算pH列的跨度</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>pH<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>pH<span class="token punctuation">)</span><span class="token punctuation">,</span>SPREAD<span class="token punctuation">(</span>pH<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_pH <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_pH
<span class="token operator">+</span><span class="token comment">---------------------+-----+-----+--------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> max <span class="token operator">|</span> min <span class="token operator">|</span> spread <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----+-----+--------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">8</span>   <span class="token operator">|</span> <span class="token number">6</span>   <span class="token operator">|</span> <span class="token number">2</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----+-----+--------+</span>
<span class="token number">4</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="distinct" tabindex="-1"><a class="header-anchor" href="#distinct" aria-hidden="true">#</a> DISTINCT()</h2><p>返回对指定Field列去重后的数据集，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>指定时间范围，去重pH列数据</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span><span class="token punctuation">(</span>pH<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_pH <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token number">1565827200000000000</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token number">1568851200000000000</span>
name: h2o_pH
<span class="token operator">+</span><span class="token comment">---------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> <span class="token keyword">distinct</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+----------+</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">6</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">7</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1565827200000000001</span> <span class="token operator">|</span> <span class="token number">8</span>        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+----------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>指定时间线（Tag）去重数据</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span><span class="token punctuation">(</span>pH<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_pH <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-09T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-23T00:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> 
name: h2o_pH
<span class="token operator">+</span><span class="token comment">---------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> <span class="token keyword">distinct</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+----------+</span>
<span class="token operator">|</span> <span class="token number">1567987200000000001</span> <span class="token operator">|</span> <span class="token number">7</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567987200000000001</span> <span class="token operator">|</span> <span class="token number">8</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1567987200000000001</span> <span class="token operator">|</span> <span class="token number">6</span>        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+----------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="rate" tabindex="-1"><a class="header-anchor" href="#rate" aria-hidden="true">#</a> RATE()</h2><p>返回一定时间范围内指定Field列数据的平均变化率/秒，计算公式：( |A<sub>n</sub>-A<sub>1</sub>| ) / ( |T<sub>n</sub>-T<sub>1</sub>|)。不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>若数据集包含多条时间线数据，则使用其中一条时间线数据来计算，因此在使用时建议给出Tag来指定时间线。</p></div><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> RATE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>给定时间范围，计算温度的平均变化率</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">---------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> degrees <span class="token operator">|</span> location     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token number">1568246760000000000</span> <span class="token operator">|</span> <span class="token number">67</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568247120000000000</span> <span class="token operator">|</span> <span class="token number">68</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568247480000000000</span> <span class="token operator">|</span> <span class="token number">64</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568247840000000000</span> <span class="token operator">|</span> <span class="token number">62</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568248200000000000</span> <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568248560000000000</span> <span class="token operator">|</span> <span class="token number">70</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568248920000000000</span> <span class="token operator">|</span> <span class="token number">66</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568249280000000000</span> <span class="token operator">|</span> <span class="token number">64</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568249640000000000</span> <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------+--------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> rate<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">---------------------+------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> rate                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+------------------------+</span>
<span class="token operator">|</span> <span class="token number">1568246760000000000</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.0024305555555555556</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+------------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>分组计算</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> rate<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location
name: h2o_temperature
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> rate                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token number">1568246760000000000</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.001388888888888889</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_temperature
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">---------------------+------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> rate                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+------------------------+</span>
<span class="token operator">|</span> <span class="token number">1568246760000000000</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.0024305555555555556</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+------------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="irate" tabindex="-1"><a class="header-anchor" href="#irate" aria-hidden="true">#</a> IRATE()</h2><p>返回指定Field列数据的实时变化率/秒，计算公式：( |A<sub>n</sub>-A<sub>n-1</sub>| ) / ( |T<sub>n</sub>-T<sub>n-1</sub>|)。A<sub>n</sub>和A<sub>n-1</sub>分别表示给定时间范围内最新的两条数据。不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>时间范围条件的常见写法为：now()-5m, 或者 now()-10m</p></div><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> IRATE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>给定时间范围，计算温度的平均变化率</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">---------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> degrees <span class="token operator">|</span> location     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token number">1568246760000000000</span> <span class="token operator">|</span> <span class="token number">67</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568247120000000000</span> <span class="token operator">|</span> <span class="token number">68</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568247480000000000</span> <span class="token operator">|</span> <span class="token number">64</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568247840000000000</span> <span class="token operator">|</span> <span class="token number">62</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568248200000000000</span> <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568248560000000000</span> <span class="token operator">|</span> <span class="token number">70</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568248920000000000</span> <span class="token operator">|</span> <span class="token number">66</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568249280000000000</span> <span class="token operator">|</span> <span class="token number">64</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1568249640000000000</span> <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------+--------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> irate<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> irate                 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token number">1568249280000000000</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.011111111111111112</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>分组计算</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> irate<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location
name: h2o_temperature
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> irate         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token number">1568249280000000000</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.013888888888888888</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_temperature
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                <span class="token operator">|</span> irate         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token operator">|</span> <span class="token number">1568249280000000000</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token number">0.011111111111111112</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+-----------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="moving-average" tabindex="-1"><a class="header-anchor" href="#moving-average" aria-hidden="true">#</a> MOVING_AVERAGE()</h2><p>返回指定Field列的滑动窗口平均值, 不支持对Tag列计算，不支持SLIMIT和SOFFSET，不支持按time分组。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> MOVING_AVERAGE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token operator">&lt;</span>N<span class="token operator">&gt;</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算water_level 字段两个值窗口的滚动平均值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> water_level <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.782</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.881</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.104</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.225</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.307</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.373</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MOVING_AVERAGE<span class="token punctuation">(</span>water_level<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> moving_average     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.733</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.8315</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.9055</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.0170000000000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.1645000000000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.266</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.34</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第一个结果 (2.733) 是原始数据中前两点的平均值：(2.684 + 2.782) / 2)。 第二个结果 (2.8315) 是原始数据中后两个点的平均值：(2.881 + 2.93) / 2)。</p><p><strong>按location分组计算滑动窗口平均值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> MOVING_AVERAGE<span class="token punctuation">(</span>water_level<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location
name: h2o_feet
tags: location<span class="token operator">=</span>coyote_creek
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> moving_average     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.5600000000000005</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.3995</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.2455</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.090999999999999</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.9319999999999995</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.7749999999999995</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.6289999999999996</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.4875</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

name: h2o_feet
tags: location<span class="token operator">=</span>santa_monica
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> moving_average     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.733</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.8315</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.9055</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.0170000000000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.1645000000000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.266</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.34</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="holt-winters" tabindex="-1"><a class="header-anchor" href="#holt-winters" aria-hidden="true">#</a> HOLT_WINTERS()</h2><p>返回给定Field列N个预测值，HOLT_WINTERS根据预测值与实际值对比来辅助发现异常点，也可以预测未来可能超过设定阈值的大致时间。不支持对Tag列计算，不支持SLIMIT和SOFFSET，不支持HOLT_WINTERS_WITH-FIT。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> HOLT_WINTERS<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">function</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>N<span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>S<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> GROUP_BY_clause <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>根据原始数据预测未来3小时和5小时的数据</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> water_level <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.782</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.881</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.104</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.225</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.307</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.373</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.455</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.579</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.678</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.835</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.95</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.016</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.068</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.226</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.367</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.436</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.56</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.652</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.751</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.856</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.957</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">5.066</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">5.161</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">5.194</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">5.348</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">5.476</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">29</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">FIRST</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">1</span>h<span class="token punctuation">,</span><span class="token number">6</span>m<span class="token punctuation">)</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> <span class="token keyword">first</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">11</span>T23:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token operator">&lt;</span>nil<span class="token operator">&gt;</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.579</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T02:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">4.652</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> HOLT_WINTERS<span class="token punctuation">(</span><span class="token function">FIRST</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">1</span>h<span class="token punctuation">,</span><span class="token number">6</span>m<span class="token punctuation">)</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> holt_winters       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T03:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">6.09448440489647</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T04:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">9.9270949466756</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T05:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15.233234117005084</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> HOLT_WINTERS<span class="token punctuation">(</span><span class="token function">FIRST</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">1</span>h<span class="token punctuation">,</span><span class="token number">6</span>m<span class="token punctuation">)</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> holt_winters       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T03:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">6.09448440489647</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T04:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">9.9270949466756</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T05:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">15.233234117005084</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T06:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">21.9164342386234</span>   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T07:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">39.25458327752615</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询返回5条预测数据，由<code>(func(Field_Key),N,S)</code>的N决定，返回数据之间的时间间隔为1小时，是由分组的<code>time(1h,6m)</code>决定，6m是时间偏移量，所以每条预测的数据都是整点过后6分钟。</p><ul><li><p>时间分组<code>time(T,offset)</code>的<code>T</code>如何确定？</p><p>对于周期分布的时间序列数据集，一般设置为数据每个波峰和波谷的时间间隔。offset为调整参数。</p></li><li><p><code>(func(Field_Key),N,S)</code>中<code>func</code>如何确定？</p><p>数据采样方法，可以是FIRST、LAST、MEAN。根据实际的数据分布情况而定。</p></li><li><p><code>(func(Field_Key),N,S)</code>中<code>S</code>如何确定？</p><p><code>S</code>表示一个周期内数据模式包含的关键数据点个数。比如一个数据周期内，按时间<code>T</code>进行分割，每个区域的第一个点（<code>FIRST</code>）连线就是数据模式，能整体表现出数据的分布形状，<code>S</code>就是模式中点的个数。</p></li></ul>`,160),b={href:"https://docs.influxdata.com/influxdb/v1/query_language/functions/#holt_winters",target:"_blank",rel:"noopener noreferrer"},v=a(`<h2 id="cumulative-sum" tabindex="-1"><a class="header-anchor" href="#cumulative-sum" aria-hidden="true">#</a> CUMULATIVE_SUM()</h2><p>返回指定Field列的累积和，不支持对Tag列计算，不支持SLIMIT和SOFFSET</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CUMULATIVE_SUM<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算water_level列数据累计和</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> water_level <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.782</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.881</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.104</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.225</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.307</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.373</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.455</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> CUMULATIVE_SUM<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> cumulative_sum     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">5.466</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">8.347</span>              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">11.277</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">14.206999999999999</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">17.311</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">20.536</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">23.843</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">27.216</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T01:<span class="token number">00</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">30.671</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第一个值2.684保持不变，第二个值5.466为原始数据前两个数之和（2.684 + 2.782 = 5.466），第三个值8.347为前三个数之和，或者说第二个值与原始数据的第三个数之和（2.684 + 2.782 + 2.881 = 8.347）。</p><p><strong>高级用法</strong></p><p>先按时间分组求平均值，再计算每个分组的累积和</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> CUMULATIVE_SUM<span class="token punctuation">(</span>mean_water<span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">as</span> mean_water <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">12</span>m<span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em>以下用法不支持</em> <code>CUMULATIVE_SUM(MEAN(&quot;water_level&quot;))</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> CUMULATIVE_SUM<span class="token punctuation">(</span>MEAN<span class="token punctuation">(</span><span class="token string">&quot;water_level&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T03:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">12</span>m<span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="derivative" tabindex="-1"><a class="header-anchor" href="#derivative" aria-hidden="true">#</a> DERIVATIVE()</h2><p>返回指定Field列的值之间的连续变化率，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> DERIVATIVE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token punctuation">,</span> <span class="token operator">&lt;</span>unit<span class="token operator">&gt;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算water_level的连续变化率</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> water_level <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.782</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.881</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.104</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.225</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.307</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.373</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DERIVATIVE<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> derivative             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.0002722222222222218</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.0002749999999999993</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.00013611111111111216</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>                      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.0004833333333333331</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.0003361111111111111</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.00022777777777777738</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.00018333333333333412</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+------------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>计算公式：(A<sub>2</sub> - A<sub>1</sub>）/（T<sub>2</sub> - T<sub>1</sub>)</p><p>第一个值<code>0.0002722222222222218</code>的为原始数据第二个数与第一个数的差值再除这两个数据之间换算成秒(s)的时间间隔 (2.782 - 2.684) / 360 = 0.0002722222222222218，第二个值<code>0.0002749999999999993</code>为原始数据第三个数与第二个数的差值再除这两个数据之间换算成秒(s)的时间间隔 (2.881 - 2.782) / 360 = 0.0002749999999999993.</p><h2 id="difference" tabindex="-1"><a class="header-anchor" href="#difference" aria-hidden="true">#</a> DIFFERENCE()</h2><p>返回指定Field列的连续差值，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> DIFFERENCE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算water_level的连续差值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> water_level <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.782</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.881</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.104</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.225</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.307</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.373</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DIFFERENCE<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+---------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> difference          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.09799999999999986</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.09899999999999975</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.04900000000000038</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>                   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.17399999999999993</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.121</span>               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.08199999999999985</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.06600000000000028</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第一个值<code>0.09799999999999986</code>为原始数据第二个数与第一个数的差值(2.782 - 2.684 = 0.09799999999999986)，第二个值<code>0.09899999999999975</code>为原始数据第三个数与第二个数的差值(2.881 - 2.782 = 0.09899999999999975)。</p><p><strong>高级用法</strong></p><p><em>不支持如下用法</em></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DIFFERENCE<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">function</span><span class="token operator">&gt;</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> GROUP_BY_clause <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>换一种方法可实现</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> DIFFERENCE<span class="token punctuation">(</span>max_water<span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">as</span> max_water <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">12</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+---------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> difference          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.19699999999999962</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.04900000000000038</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.29499999999999993</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.14800000000000013</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="elapsed" tabindex="-1"><a class="header-anchor" href="#elapsed" aria-hidden="true">#</a> ELAPSED()</h2><p>返回指定Field列的连续时间戳差值，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ELAPSED<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token punctuation">,</span> <span class="token operator">&lt;</span>unit<span class="token operator">&gt;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算water_level列连续的时间戳差值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> water_level <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> water_level <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.684</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.782</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.881</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2.93</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.104</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.225</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.307</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3.373</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> ELAPSED<span class="token punctuation">(</span>water_level<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_feet <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-09-12T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-09-12T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_feet
<span class="token operator">+</span><span class="token comment">----------------------+--------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> elapsed      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">12</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">360000000000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+--------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="non-negative-derivative" tabindex="-1"><a class="header-anchor" href="#non-negative-derivative" aria-hidden="true">#</a> NON_NEGATIVE_DERIVATIVE()</h2><p>相比<a href="#derivative">DERIVATIVE()</a>，NON_NEGATIVE_DERIVATIVE 顾名思义仅返回非负值连续变化率，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> NON_NEGATIVE_DERIVATIVE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token punctuation">,</span> <span class="token operator">&lt;</span>unit<span class="token operator">&gt;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算degrees字段的非负连续变化率</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-08-17T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-08-17T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">----------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> degrees <span class="token operator">|</span> location     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">62</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">62</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">64</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">61</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------+--------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> NON_NEGATIVE_DERIVATIVE<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-08-17T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-08-17T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> non_negative_derivative <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.005555555555555556</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>                       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.008333333333333333</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.002777777777777778</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>不支持如下内嵌函数的用法</em></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT NON_NEGATIVE_DERIVATIVE(&lt;function&gt; ([ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ]) [ , &lt;unit&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>可改为SELECT 子查询实现</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> NON_NEGATIVE_DERIVATIVE<span class="token punctuation">(</span>mean_degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> MEAN<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">as</span> mean_degrees <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-08-17T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-08-17T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">time</span><span class="token punctuation">(</span><span class="token number">12</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> non_negative_derivative <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.002777777777777778</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0.002777777777777778</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="non-negative-difference" tabindex="-1"><a class="header-anchor" href="#non-negative-difference" aria-hidden="true">#</a> NON_NEGATIVE_DIFFERENCE()</h2><p>相比<a href="#difference">DIFFERENCE()</a>，NON_NEGATIVE_DIFFERENCE 顾名思义仅返回指定Field列的非负值连续差值，不支持对Tag列计算，不支持SLIMIT和SOFFSET。</p><p><strong>语法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> NON_NEGATIVE_DIFFERENCE<span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">&lt;</span>field_key<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">/</span><span class="token operator">&lt;</span>regular_expression<span class="token operator">&gt;</span><span class="token operator">/</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span>INTO_clause<span class="token punctuation">]</span> FROM_clause <span class="token punctuation">[</span>WHERE_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>GROUP_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER_BY_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>LIMIT_clause<span class="token punctuation">]</span> <span class="token punctuation">[</span>OFFSET_clause<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例</strong></p><p><strong>计算degrees字段的非负连续差值</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-08-17T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-08-17T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">----------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> degrees <span class="token operator">|</span> location     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------+--------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">06</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">62</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">62</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">24</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">60</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">64</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">42</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">63</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">54</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">61</span>      <span class="token operator">|</span> santa_monica <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+---------+--------------+</span>
<span class="token number">3</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>

<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> NON_NEGATIVE_DIFFERENCE<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> <span class="token keyword">FROM</span> h2o_temperature <span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;</span> <span class="token string">&#39;2019-08-17T00:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;</span> <span class="token string">&#39;2019-08-17T01:00:00Z&#39;</span> <span class="token operator">AND</span> location<span class="token operator">=</span><span class="token string">&#39;santa_monica&#39;</span>
name: h2o_temperature
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">time</span>                 <span class="token operator">|</span> non_negative_difference <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">12</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">2</span>                       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">18</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>                       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">30</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">3</span>                       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">36</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">1</span>                       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">17</span>T00:<span class="token number">48</span>:<span class="token number">00</span>Z <span class="token operator">|</span> <span class="token number">0</span>                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------------+-------------------------+</span>
<span class="token number">2</span> <span class="token keyword">columns</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>不支持如下内嵌函数的用法</em>，可使用SELECT 子查询替代</p>`,61);function g(w,y){const e=l("ExternalLinkIcon");return t(),r("div",null,[k,s("div",i,[u,s("p",null,[n("openGemini提供的函数兼容InfluxDB的用法，可参考InfluxDB对应的"),s("a",m,[n("函数用法"),p(e)]),n("。")])]),d,s("p",null,[n("参考"),s("a",b,[n("InfluxDB‘s HOLT_WINTERS"),p(e)])]),v])}const T=o(c,[["render",g],["__file","aggregate.html.vue"]]);export{T as default};
